USDA Organic Program Enforcement Analysis 
This repository contains data sourced from the Data Liberation Project, via a freedom of information act request(FOIA) for the US Department of Agriculture’s National Organic Program. 

FOIA Records
The records provided by the US Department of Agriculture’s National Organic Program can be viewed here: https://www.data-liberation-project.org/datasets/usda-organic-program-enforcement/

Code 
This repository contains one Malloy code file: 
US_Organic_Program_Enforcement.malloy, performs the analysis of the data provided by the Data Liberation Project. 

Licensing
The files provided directly via FOIA (see listing above) are, as government documents, now in the public domain. All other data files have been generated by Josh Hyer for Gonzaga University Graduate School of Business as part of the MSBA-622-01 Data Science for Business (Spring 2025) course and are available under Creative Commons’ CC BY-SA 4.0 license terms. This repository’s code is available under the MIT License terms.

Motivation 
Within the world of agriculture there is always a looming pressure to perform well. With the added pressure comes the risk of fraud and other misconduct among those in the agricultural sphere. According to the U.S. Department of Agriculture website they have been involved in many intense and intricate investigations that you can read more about here: https://www.rma.usda.gov/about-rma/department-justice-prosecutions The purpose of this analysis was to find trends of the different investigations that had occurred under this US department's purview. 

Summary of Findings
Much like deep sea divers uncovering lost treasure in the ocean, as analysts we too must discover the truth hiding beneath the waves of a sea of data. While going through this dataset we will uncover some very interesting  findings that will help us understand the bigger picture of what is happening in the world of US agriculture. While going through the data we will find that there are some organizations with a propensity for repeated investigations of illegal agricultural practices.  
We will also find that certain cases will actually lead to civil fines that can range from a few hundred dollars to several thousands of dollars. All of our observations will ultimately be targeted at trying to discover if the US Department of Agriculture has been having an acceptable amount of fraud discovered or if decision makers at the government level need to re-evaluate the effectiveness of this organization's investigatory skills. 
Note: Please see pdf for sample of visualiztions that will be seen in analysis. 

Directions on how to use the github web editor to run the same analysis
Please see below for the code that you should use in your source code block to run this analysis in the github web editor:

source: USDA_Organic_Program_Enforcement is duckdb.table('USDA_Organic_Program_Enforcement.csv') extend{

    dimension: 
    replace_commas_collected_amount is replace(`Collected Amount`,',', '')
    replace_dollar_sign_collected_amount is replace(replace_commas_collected_amount,'$', '')
    collected_amt is replace(replace_dollar_sign_collected_amount,' ', ''):::number
    date_opened is strptime!timestamp(`Date/Time Opened`, '%-m/%-d/%Y %-H:%M')
    date_closed is strptime!timestamp(`Date/Time Case Closed`, '%-m/%-d/%Y %-H:%M')
    date_closed_year is date_closed.year
    dif_in_days is days(date_opened to date_closed)
    measure: 
    total_cases is count()
    complaint_type_fraud is count() {where: `Complaint Type` = 'Fraud'}
    complaint_type_labeling_error is count() {where: `Complaint Type` = 'Labeling Error'}
    complaint_type_other is count() {where: `Complaint Type` = 'Other'}
    complaint_type_pesticide_residue is count() {where: `Complaint Type` = 'Pesticide Residue'}
    complaint_type_prohibited_practice is count() {where: `Complaint Type` = 'Prohibited Practice'}
    complaint_type_prohibited_substance is count() {where: `Complaint Type` = 'Prohibited Substance'}
    complaint_type_reinstatement is count() {where: `Complaint Type` = 'Reinstatement'}
    complaint_type_uncertified_operation is count() {where: `Complaint Type` = 'Uncertified Operation'}
    most_common_account_name is count(`Account Name`)
    outcome_appeal is count() {where: `Outcomes` = 'Appeal'}
    outcome_civil_penalty is count() {where: `Outcomes` = 'Civil Penalty'}
    outcome_compliance is count() {where: `Outcomes` = 'Compliance'}
    outcome_fradulent_certificate_posted is count() {where: `Outcomes` = 'Fradulent Certificate Posted'}
    outcome_labels_changed is count() {where: `Outcomes` = 'Labels changed'}
    outcome_no_investigation is count() {where: `Outcomes` = 'No Investigation'}
    outcome_no_violation is count() {where: `Outcomes` = 'No Violation'}
    outcome_nonc is count() {where: `Outcomes` = 'NONC'}
    outcome_operator_certification is count() {where: `Outcomes` = 'Operator Certification'}
    outcome_other is count() {where: `Outcomes` = 'Other'}
    outcome_proposed_revocation is count() {where: `Outcomes` = 'Proposed Revocation'}
    outcome_proposed_suspension is count() {where: `Outcomes` = 'Proposed Suspension'}
    outcome_settlement is count() {where: `Outcomes` = 'Settlement'}
    total_collect_amt is sum(collected_amt)
    avg_collected_amt is avg(collected_amt)
    max_collected_amount is max(collected_amt)
    min_collected_amount is min(collected_amt)
    avg_days is avg(dif_in_days)

}

